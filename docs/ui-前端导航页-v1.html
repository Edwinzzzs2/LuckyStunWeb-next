<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LuckyStunWeb - å¯¼èˆªé¡µ UIï¼ˆV1ï¼‰</title>
    <script>
      ;(() => {
        const stored = localStorage.getItem('ui_theme')
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        const theme = stored || 'system'
        const isDark = theme === 'dark' || (theme === 'system' && prefersDark)
        document.documentElement.classList.toggle('dark', isDark)
        document.documentElement.style.colorScheme = isDark ? 'dark' : 'light'
      })()
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              brand: {
                50: '#eff6ff',
                100: '#dbeafe',
                200: '#bfdbfe',
                300: '#93c5fd',
                400: '#60a5fa',
                500: '#3b82f6',
                600: '#2563eb',
                700: '#1d4ed8',
                800: '#1e40af',
                900: '#1e3a8a'
              },
              slatex: {
                950: '#0b1220'
              }
            },
            boxShadow: {
              card: '0 10px 30px rgba(2, 6, 23, 0.08)',
              float: '0 20px 50px rgba(2, 6, 23, 0.14)'
            }
          }
        }
      }
    </script>
  </head>
  <body class="bg-slate-50 text-slate-900 antialiased overflow-hidden dark:bg-slate-950 dark:text-slate-100">
    <div class="h-screen overflow-hidden">
      <div class="flex h-full">
        <aside id="sidebar" class="hidden lg:flex w-[264px] shrink-0 flex-col bg-white text-slate-700 border-r border-slate-200 dark:bg-slate-950 dark:text-slate-200 dark:border-white/10 transition-all duration-200">
          <div class="h-14 px-5 flex items-center gap-3 border-b border-slate-200 dark:border-white/10">
            <div class="h-8 w-8 rounded-lg bg-brand-600/95 flex items-center justify-center font-semibold text-white">K</div>
            <div class="font-semibold tracking-wide">NavSphereå¯¼èˆª</div>
          </div>
          <nav class="flex-1 px-3 py-4 overflow-auto" aria-label="ä¾§è¾¹æ ">
            <div id="navList" class="space-y-5"></div>
          </nav>
          <div class="px-5 py-4 border-t border-slate-200 dark:border-white/10">
            <div class="flex items-center justify-between">
              <div class="text-xs text-slate-500 dark:text-slate-400">LuckyStunWeb</div>
              <div class="text-xs text-slate-400 dark:text-slate-500">UI V1</div>
            </div>
          </div>
        </aside>

        <div class="flex-1 min-w-0 flex flex-col h-full">
          <header class="sticky top-0 z-30 bg-white/85 backdrop-blur border-b border-slate-200 dark:bg-slate-950/70 dark:border-white/10">
            <div class="h-14 px-4 lg:px-7 flex items-center gap-3">
              <div class="flex items-center gap-2">
                <button
                  id="sidebarToggle"
                  type="button"
                  class="inline-flex items-center justify-center h-10 w-10 rounded-lg hover:bg-slate-100 active:bg-slate-200 transition dark:hover:bg-white/10 dark:active:bg-white/15"
                  aria-label="åˆ‡æ¢ä¾§è¾¹æ "
                >
                  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 7h14M7 12h14M7 17h14" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
                    <path d="M4.25 7.05h.01M4.25 12.05h.01M4.25 17.05h.01" stroke="currentColor" stroke-width="3.2" stroke-linecap="round" />
                  </svg>
                </button>
                <div class="hidden lg:flex items-center gap-2">
                  <div class="font-semibold">å¯¼èˆª</div>
                </div>
              </div>

              <div class="flex-1 min-w-0 hidden md:flex items-center justify-center">
                <div class="w-full max-w-[560px] relative">
                  <div class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-slate-400 dark:text-slate-500">
                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
                      <path d="M10.5 18a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15Z" stroke="currentColor" stroke-width="1.8" />
                    </svg>
                  </div>
                  <input
                    id="searchInput"
                    type="text"
                    placeholder="æœç´¢å¯¼èˆª..."
                    class="w-full h-10 pl-9 pr-10 rounded-xl border border-slate-200 bg-white/90 text-sm outline-none focus:ring-2 focus:ring-brand-200 focus:border-brand-200 dark:border-white/10 dark:bg-white/5 dark:focus:ring-brand-700/30 dark:focus:border-brand-700"
                  />
                  <div class="pointer-events-none absolute inset-y-0 right-3 hidden lg:flex items-center text-slate-400 dark:text-slate-500">
                    <span class="text-[11px] px-1.5 py-0.5 rounded-md border border-slate-200 bg-white dark:border-white/10 dark:bg-white/5">âŒ˜ K</span>
                  </div>
                </div>
              </div>

              <div class="flex items-center gap-2 ml-auto">
                <div class="relative">
                  <button
                    id="networkBtn"
                    type="button"
                    class="inline-flex items-center gap-2 h-10 px-3 rounded-xl border border-slate-200 bg-slate-50 hover:bg-slate-100 active:bg-slate-200 transition dark:border-white/10 dark:bg-white/5 dark:hover:bg-white/10 dark:active:bg-white/15"
                    aria-haspopup="menu"
                    aria-expanded="false"
                  >
                    <span class="inline-flex items-center justify-center h-5 w-5 text-slate-500 dark:text-slate-300">
                      <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z" stroke="currentColor" stroke-width="1.8" />
                        <path d="M3.8 9h16.4M3.8 15h16.4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
                        <path d="M12 3c2.4 2.3 3.8 5.4 3.8 9s-1.4 6.7-3.8 9c-2.4-2.3-3.8-5.4-3.8-9s1.4-6.7 3.8-9Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round" />
                      </svg>
                    </span>
                    <span id="networkDot" class="h-2.5 w-2.5 rounded-full bg-sky-500"></span>
                    <span id="networkLabel" class="text-sm font-medium">å†…ç½‘</span>
                    <svg class="h-4 w-4 text-slate-500 dark:text-slate-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                  </button>
                  <div
                    id="networkMenu"
                    class="hidden absolute right-0 mt-2 w-52 rounded-xl border border-slate-200 bg-white shadow-float overflow-hidden dark:border-white/10 dark:bg-slate-900"
                    role="menu"
                    aria-label="ç½‘ç»œåˆ‡æ¢"
                  >
                    <button data-network="main" class="w-full text-left px-4 py-2.5 hover:bg-slate-50 active:bg-slate-100 flex items-center gap-3 dark:hover:bg-white/10 dark:active:bg-white/15" role="menuitem" type="button">
                      <span class="h-2.5 w-2.5 rounded-full bg-emerald-500"></span>
                      <span class="text-sm">å¤–ç½‘</span>
                      <span class="ml-auto text-xs text-slate-400 dark:text-slate-500">Main</span>
                    </button>
                    <button data-network="backup" class="w-full text-left px-4 py-2.5 hover:bg-slate-50 active:bg-slate-100 flex items-center gap-3 dark:hover:bg-white/10 dark:active:bg-white/15" role="menuitem" type="button">
                      <span class="h-2.5 w-2.5 rounded-full bg-amber-500"></span>
                      <span class="text-sm">å¤‡ç”¨</span>
                      <span class="ml-auto text-xs text-slate-400 dark:text-slate-500">Backup</span>
                    </button>
                    <button data-network="internal" class="w-full text-left px-4 py-2.5 hover:bg-slate-50 active:bg-slate-100 flex items-center gap-3 dark:hover:bg-white/10 dark:active:bg-white/15" role="menuitem" type="button">
                      <span class="h-2.5 w-2.5 rounded-full bg-sky-500"></span>
                      <span class="text-sm">å†…ç½‘</span>
                      <span class="ml-auto text-xs text-slate-400 dark:text-slate-500">LAN</span>
                    </button>
                  </div>
                </div>

                <button
                  id="themeToggle"
                  type="button"
                  class="inline-flex items-center justify-center h-10 w-10 rounded-lg hover:bg-slate-100 active:bg-slate-200 transition dark:hover:bg-white/10 dark:active:bg-white/15"
                  aria-label="åˆ‡æ¢æ·±æµ…è‰²"
                >
                  <svg id="themeIconSun" class="hidden h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z" stroke="currentColor" stroke-width="1.8" />
                    <path d="M12 2v2.5M12 19.5V22M4.2 4.2 6 6M18 18l1.8 1.8M2 12h2.5M19.5 12H22M4.2 19.8 6 18M18 6l1.8-1.8" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
                  </svg>
                  <svg id="themeIconMoon" class="hidden h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 13.1A7.5 7.5 0 0 1 10.9 3 9 9 0 1 0 21 13.1Z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round" />
                  </svg>
                </button>

                <a
                  href="https://github.com/"
                  target="_blank"
                  rel="noreferrer"
                  class="inline-flex items-center gap-2 h-10 px-3 rounded-lg hover:bg-slate-100 active:bg-slate-200 transition dark:hover:bg-white/10 dark:active:bg-white/15"
                >
                  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M12 .5C5.73.5.75 5.6.75 12c0 5.1 3.2 9.4 7.6 10.9.6.1.8-.3.8-.6v-2.3c-3.1.7-3.8-1.3-3.8-1.3-.5-1.4-1.3-1.7-1.3-1.7-1.1-.8.1-.8.1-.8 1.2.1 1.8 1.2 1.8 1.2 1.1 1.9 2.9 1.4 3.6 1.1.1-.8.4-1.4.7-1.7-2.5-.3-5.1-1.3-5.1-5.8 0-1.3.4-2.3 1.1-3.1-.1-.3-.5-1.5.1-3.1 0 0 .9-.3 3 .1.9-.3 1.8-.4 2.7-.4s1.8.1 2.7.4c2.1-.4 3-.1 3-.1.6 1.6.2 2.8.1 3.1.7.8 1.1 1.8 1.1 3.1 0 4.5-2.6 5.5-5.1 5.8.4.4.8 1.1.8 2.2v3.3c0 .3.2.7.8.6 4.4-1.5 7.6-5.8 7.6-10.9C23.25 5.6 18.27.5 12 .5Z"
                    />
                  </svg>
                  <span class="hidden sm:inline text-sm font-medium">GitHub</span>
                </a>
              </div>
            </div>
          </header>

          <main id="contentScroll" class="flex-1 overflow-y-auto px-4 lg:px-7 py-6">
            <div class="max-w-[1240px] mx-auto">
              <div class="space-y-8" id="sections"></div>
            </div>
          </main>
        </div>
      </div>
    </div>

    <div
      id="mobileSidebarOverlay"
      class="hidden fixed inset-0 z-40 bg-slate-950/30 dark:bg-slate-950/60"
      aria-hidden="true"
    ></div>

    <aside
      id="mobileSidebar"
      class="hidden fixed inset-y-0 left-0 z-50 w-[280px] bg-white text-slate-700 shadow-float border-r border-slate-200 dark:bg-slate-950 dark:text-slate-200 dark:border-white/10"
      aria-label="ç§»åŠ¨ç«¯ä¾§è¾¹æ "
    >
      <div class="h-14 px-5 flex items-center justify-between border-b border-slate-200 dark:border-white/10">
        <div class="flex items-center gap-3">
          <div class="h-8 w-8 rounded-lg bg-brand-600/95 flex items-center justify-center font-semibold text-white">K</div>
          <div class="font-semibold tracking-wide">NavSphereå¯¼èˆª</div>
        </div>
        <button id="mobileSidebarClose" type="button" class="h-10 w-10 rounded-lg hover:bg-slate-100 active:bg-slate-200 transition dark:hover:bg-white/10 dark:active:bg-white/15" aria-label="å…³é—­ä¾§è¾¹æ ">
          <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <nav class="px-3 py-4 overflow-auto" id="mobileNav"></nav>
    </aside>

    <div
      id="quickMenu"
      class="hidden fixed z-[60] min-w-[180px] rounded-xl border border-slate-200 bg-white shadow-float overflow-hidden dark:border-white/10 dark:bg-slate-900"
      role="menu"
      aria-label="å¿«æ·é“¾æ¥èœå•"
    >
      <button data-open="main" type="button" class="w-full text-left px-4 py-2.5 hover:bg-slate-50 active:bg-slate-100 dark:hover:bg-white/10 dark:active:bg-white/15">
        æ‰“å¼€å¤–ç½‘
      </button>
      <button data-open="backup" type="button" class="w-full text-left px-4 py-2.5 hover:bg-slate-50 active:bg-slate-100 dark:hover:bg-white/10 dark:active:bg-white/15">
        æ‰“å¼€å¤‡ç”¨
      </button>
      <button data-open="internal" type="button" class="w-full text-left px-4 py-2.5 hover:bg-slate-50 active:bg-slate-100 dark:hover:bg-white/10 dark:active:bg-white/15">
        æ‰“å¼€å†…ç½‘
      </button>
    </div>

    <script>
      const data = [
        {
          id: 'fav',
          name: 'å¸¸ç”¨æ¨è',
          icon: 'grid',
          sites: [
            {
              title: 'å¯¼èˆªåå°ç®¡ç†',
              desc: 'ç®¡ç†å¯¼èˆªç½‘å€ã€æ·»åŠ /åˆ é™¤ã€åˆ†ç±»ç­‰',
              logoText: 'ğŸ§­',
              url: 'https://example.com/console',
              backup_url: 'https://backup.example.com/console',
              internal_url: 'http://192.168.1.2:3000/console'
            },
            {
              title: 'webå¯¼èˆª',
              desc: 'å¯¼èˆªç«™æœ¬ä½“ç«™',
              logoText: 'K',
              url: 'https://example.com',
              backup_url: 'https://backup.example.com',
              internal_url: 'http://192.168.1.2:3000'
            },
            {
              title: 'åšå®¢',
              desc: 'æˆ‘çš„ä¸ªäººåšå®¢',
              logoText: 'A',
              url: 'https://blog.example.com',
              backup_url: '',
              internal_url: 'http://192.168.1.8:8080'
            },
            {
              title: 'é‡‘ä»·',
              desc: 'å®æ—¶æŸ¥çœ‹æœ€æ–°é»„é‡‘ä»·æ ¼èµ°åŠ¿å›¾',
              logoText: 'ğŸ“ˆ',
              url: 'https://gold.example.com',
              backup_url: '',
              internal_url: ''
            }
          ]
        },
        {
          id: 'docker',
          name: 'dockeråº”ç”¨',
          icon: 'docker',
          sites: [
            { title: 'memos', desc: 'memos ä¾¿ç­¾å¼ç¬”è®°', logoText: 'm', url: 'https://memos.example.com', backup_url: '', internal_url: 'http://192.168.1.10:5230' },
            { title: 'luckyåä»£', desc: 'åå‘ä»£ç†ç¥å™¨', logoText: 'S', url: 'https://lucky.example.com', backup_url: '', internal_url: 'http://192.168.1.10:16601' },
            { title: 'qbitä¸‹è½½', desc: 'ä¸‹è½½å™¨ç®¡ç†', logoText: 'qb', url: 'https://qbit.example.com', backup_url: '', internal_url: 'http://192.168.1.10:8081' },
            { title: 'é˜…è¯»', desc: 'ä¹¦å±±æœ‰è·¯å‹¤ä¸ºå¾„', logoText: 'ğŸ“š', url: 'https://read.example.com', backup_url: '', internal_url: '' },
            { title: 'cook-ç¨‹åºå‘˜åšé¥­æŒ‡å—', desc: 'ç¨‹åºå‘˜å¼€å‘çš„åšé¥­æŒ‡å—', logoText: 'ğŸ³', url: 'https://cook.example.com', backup_url: '', internal_url: '' },
            { title: 'PVEè™šæ‹Ÿæœºï¼ˆNJï¼‰', desc: 'PVE è™šæ‹ŸåŒ–å¹³å°', logoText: 'X', url: 'https://pve.example.com', backup_url: '', internal_url: 'https://192.168.1.20:8006' },
            { title: 'uptimeæœåŠ¡', desc: 'linux 0.8 æœåŠ¡', logoText: 'â±', url: 'https://uptime.example.com', backup_url: '', internal_url: '' },
            { title: 'movie', desc: 'ç®¡ç†ä¸‹è½½ç«™ã€ç”µå½±ã€å‰§é›†ã€è®¢é˜…ç­‰', logoText: 'â–¶', url: 'https://movie.example.com', backup_url: '', internal_url: 'http://192.168.1.10:8096' },
            { title: 'å…°ç©ºå›¾åºŠ', desc: 'å›¾åºŠæœåŠ¡ï¼Œä¸“é—¨å­˜å‚¨å›¾ç‰‡', logoText: 'ğŸŒˆ', url: 'https://img.example.com', backup_url: '', internal_url: 'http://192.168.1.10:8888' },
            { title: '1panelè¿ç»´', desc: 'è¿ç»´é¢æ¿ä¸­å¿ƒï¼Œä»£ç®¡ä¸»æœºé¢æ¿', logoText: '1p', url: 'https://1panel.example.com', backup_url: '', internal_url: 'http://192.168.1.10:10086' },
            { title: 'Umami', desc: 'umami ç½‘ç«™æµé‡ç›‘æ§ä¸­å¿ƒ', logoText: 'U', url: 'https://umami.example.com', backup_url: '', internal_url: 'http://192.168.1.10:3001' },
            { title: 'alistç½‘ç›˜', desc: 'alist ç½‘ç›˜å¤§å…¨é›†åˆ', logoText: 'A', url: 'https://alist.example.com', backup_url: '', internal_url: 'http://192.168.1.10:5244' },
            { title: 'emby', desc: 'å®¶åº­å½±éŸ³ä¸­å¿ƒ', logoText: 'â—‡', url: 'https://emby.example.com', backup_url: '', internal_url: 'http://192.168.1.10:8096' },
            { title: 'iyuu', desc: 'è¾…åŠ©PTç«™ç‚¹åšç§', logoText: 'iy', url: 'https://iyuu.example.com', backup_url: '', internal_url: 'http://192.168.1.10:8787' },
            { title: 'ä¸­é—´è·³è½¬é¡µ', desc: 'ç”¨äºè·³è½¬æœ€æ–°å†…ç½‘ç«¯å£åº”ç”¨', logoText: 'GO', url: 'https://go.example.com', backup_url: '', internal_url: '' }
          ]
        },
        {
          id: 'media',
          name: 'åª’ä½“èµ„è®¯',
          icon: 'media',
          sites: [
            { title: 'Hacker News', desc: 'ç§‘æŠ€èµ„è®¯ä¸è®¨è®º', logoText: 'Y', url: 'https://news.ycombinator.com', backup_url: '', internal_url: '' },
            { title: 'Reddit', desc: 'ç¤¾åŒºè®ºå›ä¸å†…å®¹èšåˆ', logoText: 'R', url: 'https://www.reddit.com', backup_url: '', internal_url: '' },
            { title: 'Product Hunt', desc: 'å‘ç°ä¼˜ç§€äº§å“', logoText: 'P', url: 'https://www.producthunt.com', backup_url: '', internal_url: '' },
            { title: 'Google Trends', desc: 'æœç´¢è¶‹åŠ¿åˆ†æ', logoText: 'G', url: 'https://trends.google.com', backup_url: '', internal_url: '' }
          ]
        },
        {
          id: 'ai',
          name: 'AIå·¥å…·åŒ…',
          icon: 'spark',
          sites: [
            { title: 'ChatGPT', desc: 'æ™ºèƒ½å¯¹è¯ä¸å†™ä½œåŠ©æ‰‹', logoText: 'C', url: 'https://chat.openai.com', backup_url: '', internal_url: '' },
            { title: 'Claude', desc: 'é«˜è´¨é‡å¯¹è¯ä¸é•¿æ–‡æœ¬ç†è§£', logoText: 'Cl', url: 'https://claude.ai', backup_url: '', internal_url: '' },
            { title: 'Gemini', desc: 'Google ç”Ÿæˆå¼ AI åŠ©æ‰‹', logoText: 'Gm', url: 'https://gemini.google.com', backup_url: '', internal_url: '' },
            { title: 'Perplexity', desc: 'å¸¦æ¥æºçš„æ™ºèƒ½æœç´¢', logoText: 'P', url: 'https://www.perplexity.ai', backup_url: '', internal_url: '' }
          ]
        }
      ]

      const iconSvg = {
        grid: `<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 5.5A1.5 1.5 0 0 1 5.5 4h3A1.5 1.5 0 0 1 10 5.5v3A1.5 1.5 0 0 1 8.5 10h-3A1.5 1.5 0 0 1 4 8.5v-3ZM14 5.5A1.5 1.5 0 0 1 15.5 4h3A1.5 1.5 0 0 1 20 5.5v3A1.5 1.5 0 0 1 18.5 10h-3A1.5 1.5 0 0 1 14 8.5v-3ZM4 15.5A1.5 1.5 0 0 1 5.5 14h3A1.5 1.5 0 0 1 10 15.5v3A1.5 1.5 0 0 1 8.5 20h-3A1.5 1.5 0 0 1 4 18.5v-3ZM14 15.5A1.5 1.5 0 0 1 15.5 14h3A1.5 1.5 0 0 1 20 15.5v3A1.5 1.5 0 0 1 18.5 20h-3A1.5 1.5 0 0 1 14 18.5v-3Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/></svg>`,
        docker: `<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 13h14c0 4-3 8-7 8s-7-4-7-8Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M8 3h3v3H8V3Zm4 0h3v3h-3V3ZM4 7h3v3H4V7Zm4 0h3v3H8V7Zm4 0h3v3h-3V7Zm4 0h3v3h-3V7Z" fill="currentColor" opacity="0.85"/></svg>`,
        media: `<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 6.5h15v11h-15v-11Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M7.5 9h9M7.5 12h7M7.5 15h6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>`,
        spark: `<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2l1.3 5.2L18.5 9l-5.2 1.3L12 15.5l-1.3-5.2L5.5 9l5.2-1.8L12 2Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M6 15l.8 3.2L10 19l-3.2.8L6 23l-.8-3.2L2 19l3.2-.8L6 15Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round" opacity="0.7"/></svg>`,
        console: `<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 6h16v12H4V6Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/><path d="M7 10l2 2-2 2M11 14h3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
        chevron: `<svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 10l4 4 4-4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>`
      }

      const menuGroups = [
        {
          label: 'å¯¼èˆª',
          items: [
            { id: 'fav', label: 'å¸¸ç”¨æ¨è', icon: 'grid', sectionId: 'fav' },
            { id: 'docker', label: 'dockeråº”ç”¨', icon: 'docker', sectionId: 'docker' },
            {
              id: 'tools',
              label: 'å¼€å‘è€…å·¥å…·',
              icon: 'grid',
              children: [
                { id: 'media', label: 'åª’ä½“èµ„è®¯', sectionId: 'media' },
                { id: 'ai', label: 'AIå·¥å…·åŒ…', sectionId: 'ai' }
              ]
            }
          ]
        },
        {
          label: 'ç³»ç»Ÿ',
          items: [{ id: 'console', label: 'è¿›å…¥æ§åˆ¶å°', icon: 'console', action: 'console' }]
        }
      ]

      const networkName = {
        main: 'å¤–ç½‘',
        backup: 'å¤‡ç”¨',
        internal: 'å†…ç½‘'
      }

      const state = {
        network: localStorage.getItem('ui_network') || 'internal',
        theme: localStorage.getItem('ui_theme') || 'system',
        search: '',
        activeSectionId: data[0]?.id || 'fav',
        sidebarCollapsed: localStorage.getItem('ui_sidebar') === 'collapsed',
        expandedMenus: new Set(JSON.parse(localStorage.getItem('ui_menu_expanded') || '[]')),
        quickMenu: {
          open: false,
          x: 0,
          y: 0,
          site: null
        }
      }

      function normalizeUrl(value) {
        if (!value) return ''
        return String(value)
      }

      function resolveTargetUrl(site, network) {
        const main = normalizeUrl(site.url)
        const backup = normalizeUrl(site.backup_url)
        const internal = normalizeUrl(site.internal_url)

        if (network === 'backup' && backup) return backup
        if (network === 'internal' && internal) return internal
        return main
      }

      const fallbackLogo =
        'data:image/svg+xml;utf8,' +
        encodeURIComponent(
          `<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64"><rect width="64" height="64" rx="16" fill="#E2E8F0"/><path d="M20 33c0-6.627 5.373-12 12-12s12 5.373 12 12-5.373 12-12 12-12-5.373-12-12Z" fill="#94A3B8"/></svg>`
        )

      function getSiteLogoUrl(site) {
        if (site.logo) return site.logo
        const candidate = normalizeUrl(site.url) || normalizeUrl(site.backup_url) || normalizeUrl(site.internal_url)
        if (!candidate) return ''
        try {
          const u = new URL(candidate)
          return `https://www.google.com/s2/favicons?domain=${u.hostname}&sz=64`
        } catch {
          return ''
        }
      }

      function persistExpandedMenus() {
        localStorage.setItem('ui_menu_expanded', JSON.stringify(Array.from(state.expandedMenus)))
      }

      function scrollToSection(sectionId) {
        state.activeSectionId = sectionId
        renderAll()
        const anchor = document.getElementById(`sec-${sectionId}`)
        if (anchor) anchor.scrollIntoView({ behavior: 'smooth', block: 'start' })
      }

      function renderSidebar(container) {
        container.innerHTML = ''

        for (const group of menuGroups) {
          const groupWrap = document.createElement('div')
          groupWrap.className = 'space-y-1'

          const title = document.createElement('div')
          title.className = 'px-3 text-xs text-slate-400 dark:text-slate-500'
          title.textContent = group.label
          groupWrap.appendChild(title)

          const list = document.createElement('div')
          list.className = 'space-y-1'
          groupWrap.appendChild(list)

          for (const item of group.items) {
            list.appendChild(renderMenuItem(item, 0))
          }

          container.appendChild(groupWrap)
        }
      }

      function renderMenuItem(item, level) {
        const wrap = document.createElement('div')
        const isActive = item.sectionId && state.activeSectionId === item.sectionId
        const hasChildren = Array.isArray(item.children) && item.children.length > 0
        const isExpanded = hasChildren && state.expandedMenus.has(item.id)

        const btn = document.createElement('button')
        btn.type = 'button'
        btn.className = `w-full flex items-center gap-3 px-3 py-2 rounded-xl transition ${
          isActive
            ? 'bg-slate-100 text-slate-900 dark:bg-white/10 dark:text-white'
            : 'text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-300 dark:hover:bg-white/10 dark:hover:text-white'
        }`
        btn.style.paddingLeft = `${12 + level * 14}px`

        const icon = document.createElement('span')
        icon.className = 'inline-flex items-center justify-center h-5 w-5 text-slate-500 dark:text-slate-400'
        icon.innerHTML = iconSvg[item.icon] || iconSvg.grid

        const label = document.createElement('span')
        label.className = 'text-sm font-medium truncate'
        label.textContent = item.label

        btn.appendChild(icon)
        btn.appendChild(label)

        if (hasChildren) {
          const chevron = document.createElement('span')
          chevron.className = `ml-auto text-slate-400 dark:text-slate-500 transition ${isExpanded ? 'rotate-180' : ''}`
          chevron.innerHTML = iconSvg.chevron
          btn.appendChild(chevron)
        }

        btn.addEventListener('click', (e) => {
          e.preventDefault()
          if (hasChildren) {
            if (state.expandedMenus.has(item.id)) state.expandedMenus.delete(item.id)
            else state.expandedMenus.add(item.id)
            persistExpandedMenus()
            renderAll()
            return
          }
          if (item.action === 'console') {
            openConsole()
            closeMobileSidebar()
            return
          }
          if (item.sectionId) {
            scrollToSection(item.sectionId)
            closeMobileSidebar()
          }
        })

        wrap.appendChild(btn)

        if (hasChildren) {
          const childWrap = document.createElement('div')
          childWrap.className = `${isExpanded ? 'mt-1' : 'hidden'} ml-8 pl-3 border-l border-slate-200 dark:border-white/10 space-y-1`
          for (const child of item.children) {
            childWrap.appendChild(renderMenuChild(child, level + 1))
          }
          wrap.appendChild(childWrap)
        }

        return wrap
      }

      function renderMenuChild(item, level) {
        const isActive = item.sectionId && state.activeSectionId === item.sectionId
        const btn = document.createElement('button')
        btn.type = 'button'
        btn.className = `w-full flex items-center gap-2 px-3 py-2 rounded-xl transition ${
          isActive
            ? 'bg-slate-100 text-slate-900 dark:bg-white/10 dark:text-white'
            : 'text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-300 dark:hover:bg-white/10 dark:hover:text-white'
        }`
        btn.style.paddingLeft = `${12 + level * 14}px`

        const dot = document.createElement('span')
        dot.className = 'h-1.5 w-1.5 rounded-full bg-slate-300 dark:bg-slate-600'

        const label = document.createElement('span')
        label.className = 'text-sm truncate'
        label.textContent = item.label

        btn.appendChild(dot)
        btn.appendChild(label)

        btn.addEventListener('click', () => {
          if (item.sectionId) {
            scrollToSection(item.sectionId)
            closeMobileSidebar()
          }
        })

        return btn
      }

      function renderSections() {
        const root = document.getElementById('sections')
        root.innerHTML = ''

        const query = state.search.trim().toLowerCase()
        let renderedSections = 0
        const devToolSectionIds = new Set(['media', 'ai'])
        let devToolHeaderRendered = false

        for (const section of data) {
          const sites = query
            ? section.sites.filter((s) => {
                const hay = `${s.title || ''} ${(s.desc || '')}`.toLowerCase()
                return hay.includes(query)
              })
            : section.sites

          if (!sites.length) continue

          if (devToolSectionIds.has(section.id) && !devToolHeaderRendered) {
            devToolHeaderRendered = true
            const groupTitle = document.createElement('div')
            groupTitle.className = 'pt-2'
            groupTitle.innerHTML = `
              <div class="flex items-center justify-between">
                <div class="text-base font-semibold">å¼€å‘è€…å·¥å…·</div>
              </div>
            `
            root.appendChild(groupTitle)
          }

          const wrapper = document.createElement('section')
          wrapper.id = `sec-${section.id}`
          wrapper.className = 'scroll-mt-20'

          wrapper.innerHTML = `
            <div class="flex items-center justify-between gap-4">
              <div class="text-[15px] font-semibold">${section.name}</div>
            </div>
            <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3" data-grid="${section.id}"></div>
          `

          root.appendChild(wrapper)
          renderedSections += 1

          const grid = wrapper.querySelector(`[data-grid="${section.id}"]`)
          for (const site of sites) {
            const card = document.createElement('article')
            const targetUrl = resolveTargetUrl(site, state.network)

            card.className = 'group relative rounded-xl border border-slate-200 bg-white hover:border-slate-300 hover:shadow-sm transition overflow-hidden dark:border-white/10 dark:bg-white/5 dark:hover:border-white/20'
            card.tabIndex = 0
            card.dataset.site = JSON.stringify(site)

            card.innerHTML = `
              <div class="p-3.5">
                <button
                  type="button"
                  class="absolute top-2.5 right-2.5 inline-flex items-center justify-center h-8 w-8 rounded-lg border border-slate-200 bg-white transition opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto group-focus-within:opacity-100 group-focus-within:pointer-events-auto hover:bg-slate-50 active:bg-slate-100 dark:border-white/10 dark:bg-white/5 dark:hover:bg-white/10 dark:active:bg-white/15"
                  data-action="menu"
                  aria-label="æ›´å¤šæ“ä½œ"
                >
                  <svg class="h-5 w-5 text-slate-500 dark:text-slate-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 12h.01M12 12h.01M18 12h.01" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" />
                  </svg>
                </button>

                <div class="flex items-start gap-4">
                  <div class="h-10 w-10 shrink-0 rounded-xl bg-slate-50 ring-1 ring-slate-200 overflow-hidden flex items-center justify-center dark:bg-white/10 dark:ring-white/10">
                    <img
                      class="h-6 w-6 object-contain"
                      src="${getSiteLogoUrl(site) || fallbackLogo}"
                      alt="${(site.title || '').replace(/\"/g, '&quot;')}"
                      onerror="this.onerror=null;this.src='${fallbackLogo}'"
                      loading="lazy"
                    />
                  </div>
                  <div class="min-w-0 flex-1">
                    <div class="min-w-0 truncate text-sm font-semibold">${site.title}</div>
                    <div class="mt-1 text-xs text-slate-500 dark:text-slate-400 truncate" title="${(site.desc || '').replace(/\"/g, '&quot;')}">${site.desc || ''}</div>
                  </div>
                </div>
              </div>
            `

            function openTarget(type) {
              const url = type === 'backup' ? normalizeUrl(site.backup_url) : type === 'internal' ? normalizeUrl(site.internal_url) : normalizeUrl(site.url)
              if (!url) return
              window.open(url, '_blank', 'noopener,noreferrer')
            }

            card.addEventListener('contextmenu', (e) => {
              e.preventDefault()
              showQuickMenu(e.clientX, e.clientY, site)
            })

            card.addEventListener('click', (e) => {
              const btn = e.target.closest('button')
              if (btn) return
              if (!targetUrl) return
              window.open(targetUrl, '_blank', 'noopener,noreferrer')
            })

            const menuBtn = card.querySelector('button[data-action="menu"]')
            if (menuBtn) {
              menuBtn.addEventListener('click', (e) => {
                e.preventDefault()
                e.stopPropagation()
                const rect = menuBtn.getBoundingClientRect()
                showQuickMenu(rect.left + rect.width, rect.bottom + 8, site)
              })
            }

            card.addEventListener('keydown', (e) => {
              if (e.key === 'Enter') {
                if (!targetUrl) return
                window.open(targetUrl, '_blank', 'noopener,noreferrer')
              }
              if (e.key === 'ContextMenu' || (e.shiftKey && e.key === 'F10')) {
                const rect = card.getBoundingClientRect()
                showQuickMenu(rect.left + rect.width - 16, rect.top + 16, site)
              }
            })

            grid.appendChild(card)
          }
        }

        if (!renderedSections) {
          root.innerHTML = `
            <div class="py-20">
              <div class="max-w-[420px] mx-auto text-center">
                <div class="text-base font-semibold">æ²¡æœ‰åŒ¹é…ç»“æœ</div>
                <div class="mt-2 text-sm text-slate-500 dark:text-slate-400">å°è¯•æ¢ä¸€ä¸ªå…³é”®è¯ï¼Œæˆ–æ¸…ç©ºæœç´¢ã€‚</div>
              </div>
            </div>
          `
        }
      }

      function setNetwork(type) {
        state.network = type
        localStorage.setItem('ui_network', type)
        renderNetwork()
        renderSections()
      }

      function renderNetwork() {
        const label = document.getElementById('networkLabel')
        label.textContent = networkName[state.network] || 'å¤–ç½‘'
        const dot = document.getElementById('networkDot')
        if (dot) {
          dot.classList.remove('bg-emerald-500', 'bg-amber-500', 'bg-sky-500')
          dot.classList.add(state.network === 'backup' ? 'bg-amber-500' : state.network === 'internal' ? 'bg-sky-500' : 'bg-emerald-500')
        }
        document.getElementById('networkBtn').setAttribute('aria-expanded', 'false')
      }

      function openNetworkMenu() {
        const menu = document.getElementById('networkMenu')
        menu.classList.remove('hidden')
        document.getElementById('networkBtn').setAttribute('aria-expanded', 'true')
      }

      function closeNetworkMenu() {
        const menu = document.getElementById('networkMenu')
        menu.classList.add('hidden')
        document.getElementById('networkBtn').setAttribute('aria-expanded', 'false')
      }

      function showQuickMenu(x, y, site) {
        const menu = document.getElementById('quickMenu')
        const vw = window.innerWidth
        const vh = window.innerHeight
        const w = 220
        const h = 156
        const left = Math.max(12, Math.min(x, vw - w - 12))
        const top = Math.max(12, Math.min(y, vh - h - 12))

        state.quickMenu.open = true
        state.quickMenu.site = site
        menu.style.left = left + 'px'
        menu.style.top = top + 'px'
        menu.classList.remove('hidden')

        const hasMain = !!normalizeUrl(site.url)
        const hasBackup = !!normalizeUrl(site.backup_url)
        const hasInternal = !!normalizeUrl(site.internal_url)
        menu.querySelector('[data-open="main"]').disabled = !hasMain
        menu.querySelector('[data-open="backup"]').disabled = !hasBackup
        menu.querySelector('[data-open="internal"]').disabled = !hasInternal

        for (const btn of menu.querySelectorAll('button[data-open]')) {
          btn.classList.toggle('opacity-45', btn.disabled)
          btn.classList.toggle('cursor-not-allowed', btn.disabled)
        }
      }

      function hideQuickMenu() {
        const menu = document.getElementById('quickMenu')
        state.quickMenu.open = false
        state.quickMenu.site = null
        menu.classList.add('hidden')
      }

      function openConsole() {
        const next = '/console'
        window.open(next, '_blank', 'noopener,noreferrer')
      }

      function applySidebarState() {
        const sidebar = document.getElementById('sidebar')
        if (!sidebar) return
        sidebar.classList.toggle('lg:hidden', state.sidebarCollapsed)
      }

      function toggleDesktopSidebar() {
        state.sidebarCollapsed = !state.sidebarCollapsed
        localStorage.setItem('ui_sidebar', state.sidebarCollapsed ? 'collapsed' : 'expanded')
        applySidebarState()
      }

      function openMobileSidebar() {
        document.getElementById('mobileSidebarOverlay').classList.remove('hidden')
        document.getElementById('mobileSidebar').classList.remove('hidden')
      }

      function closeMobileSidebar() {
        document.getElementById('mobileSidebarOverlay').classList.add('hidden')
        document.getElementById('mobileSidebar').classList.add('hidden')
      }

      function renderAll() {
        renderTheme()
        renderNetwork()
        applySidebarState()

        const searchInput = document.getElementById('searchInput')
        if (searchInput) searchInput.value = state.search

        renderSidebar(document.getElementById('navList'))
        renderSections()
        renderSidebar(document.getElementById('mobileNav'))
      }

      document.getElementById('networkBtn').addEventListener('click', (e) => {
        e.preventDefault()
        const menu = document.getElementById('networkMenu')
        if (menu.classList.contains('hidden')) openNetworkMenu()
        else closeNetworkMenu()
      })

      document.getElementById('networkMenu').addEventListener('click', (e) => {
        const btn = e.target.closest('button[data-network]')
        if (!btn) return
        setNetwork(btn.dataset.network)
        closeNetworkMenu()
      })

      function getEffectiveTheme() {
        if (state.theme === 'light' || state.theme === 'dark') return state.theme
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        return prefersDark ? 'dark' : 'light'
      }

      function applyTheme(theme) {
        document.documentElement.classList.toggle('dark', theme === 'dark')
        document.documentElement.style.colorScheme = theme === 'dark' ? 'dark' : 'light'
      }

      function renderTheme() {
        const effective = getEffectiveTheme()
        applyTheme(effective)
        const sun = document.getElementById('themeIconSun')
        const moon = document.getElementById('themeIconMoon')
        if (!sun || !moon) return
        sun.classList.toggle('hidden', effective !== 'light')
        moon.classList.toggle('hidden', effective !== 'dark')
      }

      function toggleTheme() {
        const next = getEffectiveTheme() === 'dark' ? 'light' : 'dark'
        state.theme = next
        localStorage.setItem('ui_theme', next)
        renderTheme()
        renderSections()
      }

      document.getElementById('quickMenu').addEventListener('click', (e) => {
        const btn = e.target.closest('button[data-open]')
        if (!btn || btn.disabled) return
        const site = state.quickMenu.site
        if (!site) return
        const type = btn.dataset.open
        const url = type === 'backup' ? normalizeUrl(site.backup_url) : type === 'internal' ? normalizeUrl(site.internal_url) : normalizeUrl(site.url)
        if (!url) return
        window.open(url, '_blank', 'noopener,noreferrer')
        hideQuickMenu()
      })

      document.addEventListener('click', (e) => {
        const networkArea = e.target.closest('#networkBtn') || e.target.closest('#networkMenu')
        if (!networkArea) closeNetworkMenu()

        const quickArea = e.target.closest('#quickMenu')
        const onCardAction = e.target.closest('button[data-action]')
        if (!quickArea && !onCardAction) hideQuickMenu()
      })

      const contentScroll = document.getElementById('contentScroll')
      if (contentScroll) {
        contentScroll.addEventListener(
          'scroll',
          () => {
            closeNetworkMenu()
            hideQuickMenu()
          },
          { passive: true }
        )
      }

      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && (e.key === 'k' || e.key === 'K')) {
          const input = document.getElementById('searchInput')
          if (!input) return
          e.preventDefault()
          input.focus()
          input.select()
          return
        }
        if (e.key === 'Escape') {
          closeNetworkMenu()
          hideQuickMenu()
          closeMobileSidebar()
          const input = document.getElementById('searchInput')
          if (input) input.blur()
        }
      })

      document.getElementById('sidebarToggle').addEventListener('click', () => {
        if (window.innerWidth >= 1024) toggleDesktopSidebar()
        else openMobileSidebar()
      })
      document.getElementById('mobileSidebarClose').addEventListener('click', closeMobileSidebar)
      document.getElementById('mobileSidebarOverlay').addEventListener('click', closeMobileSidebar)
      document.getElementById('themeToggle').addEventListener('click', toggleTheme)

      const searchInput = document.getElementById('searchInput')
      if (searchInput) {
        searchInput.addEventListener('input', () => {
          state.search = searchInput.value
          renderSections()
        })
      }

      renderAll()
    </script>
  </body>
</html>
